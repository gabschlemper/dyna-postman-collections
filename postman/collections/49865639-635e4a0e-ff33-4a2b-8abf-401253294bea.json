{
	"info": {
		"_postman_id": "49865639-635e4a0e-ff33-4a2b-8abf-401253294bea",
		"name": "PSCA",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Routes",
			"item": [
				{
					"name": "List Routes by ID",
					"id": "49865639-fa0e184a-9926-488d-b7be-9599b23438a3",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "email",
								"value": "gabriela.silva@dynamox.net"
							}
						],
						"url": {
							"raw": "{{urlpsca}}/v4/routes/{{routeId1}}",
							"host": [
								"{{urlpsca}}"
							],
							"path": [
								"v4",
								"routes",
								"{{routeId1}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "POST route",
					"id": "49865639-3275c069-41ce-494f-81e8-7cac189c49ca",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "email",
								"value": "gabriela.silva@dynamox.net"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"externalId\": null,\n    \"name\": \"Rota checklist duplicada v20\",\n    \"type\": \"periodic\",\n    \"categories\": [],\n    \"assets\": [\n        {\n            \"id\": \"684997cea235ae152f80d62f\",\n            \"title\": \"Bagel machine\",\n            \"type\": \"machine\",\n            \"parentId\": \"67c9827223fe707a890bbf3d\",\n            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67\",\n            \"alerts\": {\n                \"a1\": 2,\n                \"a2\": 1,\n                \"total\": 3,\n                \"none\": 1\n            },\n            \"class\": null,\n            \"code\": null,\n            \"businessRisk\": false,\n            \"displayFields\": null,\n            \"hasChildren\": true,\n            \"roles\": [\n                \"collector\",\n                \"mechanicalInspector\",\n                \"installer\",\n                \"administrator\",\n                \"reader\",\n                \"support\",\n                \"editor\"\n            ],\n            \"children\": [\n                {\n                    \"id\": \"684997cea235ae152f80d62f-checklistGroup\",\n                    \"type\": \"checklists\",\n                    \"parentId\": \"684997cea235ae152f80d62f\",\n                    \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67\",\n                    \"alerts\": {\n                        \"a1\": 2,\n                        \"a2\": 1,\n                        \"total\": 3,\n                        \"none\": 1\n                    },\n                    \"roles\": [\n                        \"collector\",\n                        \"mechanicalInspector\",\n                        \"installer\",\n                        \"administrator\",\n                        \"reader\",\n                        \"support\",\n                        \"editor\"\n                    ],\n                    \"children\": [\n                        {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        },\n                         {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        },\n                         {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        },\n                         {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        },\n                         {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        },\n                         {\n                            \"id\": \"9342d9ca-6cdd-4cb9-b40c-cce88cd71763\",\n                            \"title\": \"3923 - Manufacturing Boulevard\",\n                            \"type\": \"checklist\",\n                            \"parentId\": \"684997cea235ae152f80d62f\",\n                            \"path\": \"/malicious-interaction-murder-32/tender-eggs-operate-73/important-football-jail-58/bad-wash-tear-67/manufacturing-boulevard\",\n                            \"alerts\": {\n                                \"a1\": 1,\n                                \"a2\": 1,\n                                \"total\": 2,\n                                \"none\": 0\n                            },\n                            \"roles\": [\n                                \"collector\",\n                                \"mechanicalInspector\",\n                                \"installer\",\n                                \"administrator\",\n                                \"reader\",\n                                \"support\",\n                                \"editor\"\n                            ],\n                            \"expanded\": false\n                        }\n                    ],\n                    \"expanded\": true\n                }\n            ],\n            \"expanded\": true\n        }\n    ],\n    \"users\": [\n        {\n            \"userId\": \"cf5cdb56-b798-409e-bbd6-35f80463d062\",\n            \"uid\": \"qLFJdGRgbNgIriWIjfdDh6ySPmt1\",\n            \"name\": \"Gabriela Schlemper Da Silva\",\n            \"email\": \"gabriela.silva@dynamox.net\",\n            \"image\": null,\n            \"phone\": null,\n            \"roleSlug\": \"{\\\"electricalInspector\\\",\\\"lubricator\\\",\\\"mechanicalInspector\\\"}\",\n            \"roleName\": \"{NULL,NULL,NULL}\",\n            \"createdAt\": \"2025-11-25T18:00:20.850Z\",\n            \"isAccountable\": true\n        }\n    ],\n    \"team\": null,\n    \"ordenationAssetsType\": \"default\",\n    \"spectralRequired\": false,\n    \"routeWorkspaceIds\": [],\n    \"showDays\": false,\n    \"frequency\": 1,\n    \"frequencyUnit\": \"days\",\n    \"periodicities\": [],\n    \"visualization\": 0,\n    \"visualizationUnit\": \"days\",\n    \"tolerance\": 0,\n    \"toleranceUnit\": \"days\",\n    \"activatedAt\": \"2025-11-04T00:00:00Z\",\n    \"activated\": true,\n    \"contextId\": \"67c9827223fe707a890bbf3d\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{urlpsca}}/v4/routes",
							"host": [
								"{{urlpsca}}"
							],
							"path": [
								"v4",
								"routes"
							]
						}
					},
					"response": []
				}
			],
			"id": "49865639-77b6241e-3c95-4092-9116-dc4b40f28bba"
		},
		{
			"name": "Answers",
			"item": [
				{
					"name": "Save many",
					"id": "49865639-af01995f-edd5-4f70-adcb-896f9740af76",
					"protocolProfileBehavior": {
						"disableBodyPruning": true
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"answers\": [\n    {\n      \"routeId\": \"958afd6d-f5a9-4a9f-9801-714bba73c52e\",\n      \"checklistId\": \"558e8fd5-5228-463b-9906-877fb9933cab\",\n      \"quizId\": \"273aae95-ad5b-4809-9fe6-8e3843b5ea44\",\n      \"questionId\": \"c6cf007f-e855-42dd-898b-0c4c3e39a652\",\n      \"alternativeId\": \"828db3fe-55a2-4c69-9bd9-e57bffe51691\",\n      \"answeredAt\": \"2024-10-16T10:00:00Z\",\n      \"note\": \"Observação opcional\",\n      \"latitude\": -23.5505,\n      \"longitude\": -46.6333\n    }\n  ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://sandbox.predict.dynamox.solutions/psca/v4/answers/save-many",
							"protocol": "https",
							"host": [
								"sandbox",
								"predict",
								"dynamox",
								"solutions"
							],
							"path": [
								"psca",
								"v4",
								"answers",
								"save-many"
							]
						}
					},
					"response": []
				}
			],
			"id": "49865639-63d63d20-c7ec-4288-ac9b-25fdd0b9ca56"
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{authToken}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "0aaba071-f1b7-4628-a4ff-41c381c956ef",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					"function isTokenExpired(exp) {",
					"    const now = Math.floor(Date.now() / 1000);",
					"    return exp < now;",
					"}",
					"",
					"const token = pm.collectionVariables.get(\"authToken\");",
					"const exp = parseInt(pm.collectionVariables.get(\"authTokenExp\"));",
					"",
					"if (!token || !exp || isTokenExpired(exp)) {",
					"    console.log(\"Token ausente ou expirado. Requisitando novo token...\");",
					"",
					"    pm.sendRequest({",
					"        url: 'https://www.googleapis.com/identitytoolkit/v3/relyingparty/verifyPassword?key=AIzaSyCbgUaYoVbBUTy3RN2rJrfhmvdZW5G5f7k',",
					"        method: 'POST',",
					"        header: {",
					"            'Content-Type': 'application/json'",
					"        },",
					"        body: {",
					"            mode: 'raw',",
					"            raw: JSON.stringify({",
					"                email: pm.globals.get(\"email\"),",
					"                password:  pm.globals.get(\"password\"),",
					"                returnSecureToken: true",
					"            })",
					"        }",
					"    }, function (err, res) {",
					"        if (err) {",
					"            console.log(\"Erro ao obter novo token:\", err);",
					"        } else {",
					"            const jsonResponse = res.json();",
					"            const newToken = jsonResponse.idToken;",
					"            const newExp = JSON.parse(atob(newToken.split('.')[1])).exp;",
					"",
					"            pm.collectionVariables.set(\"authToken\", newToken);",
					"            pm.collectionVariables.set(\"authTokenExp\", newExp);",
					"            console.log(\"Novo token armazenado com expiração:\", newExp);",
					"        }",
					"    });",
					"} else {",
					"    console.log(\"Token ainda válido. Usando token existente.\", token);",
					"}",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "1400cda7-892d-44ce-82d0-eefe849731b2",
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "authToken",
			"value": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjU0NTEzMjA5OWFkNmJmNjEzODJiNmI0Y2RlOWEyZGZlZDhjYjMwZjAiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiR2FicmllbGEgU2NobGVtcGVyIERhIFNpbHZhIiwibGdwZCI6IjciLCJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vcHJlZGljdC1zdGFnaW5nLXBsYXRmb3JtIiwiYXVkIjoicHJlZGljdC1zdGFnaW5nLXBsYXRmb3JtIiwiYXV0aF90aW1lIjoxNzYyNDUzMzk2LCJ1c2VyX2lkIjoicUxGSmRHUmdiTmdJcmlXSWpmZERoNnlTUG10MSIsInN1YiI6InFMRkpkR1JnYk5nSXJpV0lqZmREaDZ5U1BtdDEiLCJpYXQiOjE3NjI0NTMzOTYsImV4cCI6MTc2MjQ1Njk5NiwiZW1haWwiOiJnYWJyaWVsYS5zaWx2YUBkeW5hbW94Lm5ldCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJtaWNyb3NvZnQuY29tIjpbIjZlMDhiZGVkLWZjYjItNDQyMi1hNjA4LTUxNTJiMTI3YTI4ZiJdLCJlbWFpbCI6WyJnYWJyaWVsYS5zaWx2YUBkeW5hbW94Lm5ldCJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.movCLYssJCtaK9ByMd73prS5Z4a_pO-44g0KV0lPIijdxQ4HuXo2LLjHpv9sI0BSQhAO5Fo_Tn08BciH_UcP8Xhp1I6b623QyRGTSYLDc368mxO52Lm_g1q_1-S21oMbLDDf33N6QMXk68mLogivKG46Qh-XDOeb-KPy4u9YTVQcZUQEtspdo-d6vRaJXNEGNcNNd2rhO7Prb2BtXuoj6f4bO7O5qF_uYr_O7ihf2v32RX9rGq-63YKNosaH0Ca-3BFiDol7gEL44Rjm2ynhiFXYtYmIuYw0dCHijUG5uitb6pOQkYj-5sni0BKd0onM5rDbrnnvVflISHJlGXcW4g"
		},
		{
			"key": "authTokenExp",
			"value": "1762456996"
		}
	]
}